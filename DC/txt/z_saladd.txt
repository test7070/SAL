z_saladd1:--z_saladd1
declare @t_xnoa nvarchar(10)
declare @t_bdate nvarchar(10)
declare @t_edate nvarchar(10)
declare @t_bsssno nvarchar(20)
declare @t_esssno nvarchar(20)
declare @t_bpartno nvarchar(20)
declare @t_epartno nvarchar(20)
set @t_bdate = case when '#non'=[1] then '' else [1] end
set @t_edate = case when '#non'=[2] then char(255) else [2] end
set @t_bsssno = case when '#non'=[3] then '' else [3] end
set @t_esssno = case when '#non'=[4] then char(255) else [4] end
set @t_bpartno = case when '#non'=[5] then '' else [5] end
set @t_epartno = case when '#non'=[6] then char(255) else [6] end

declare @tmp table(
	gno nvarchar(1),
	sno nvarchar(50),
	namea nvarchar(50),
	noa nvarchar(50),
	datea nvarchar(10),
	typea nvarchar(50),
	timea nvarchar(50),
	hr float,
	memo nvarchar(max)
)
insert @tmp 
select '0',sssno,namea,noa,datea,typea,btime+' ~ '+etime,hours,memo
from saladd
where (datea between @t_bdate and @t_edate)
and (sssno between @t_bsssno and @t_esssno)

insert @tmp(gno,sno)
select '1',sno
from @tmp
group by sno

select * from @tmp
order by sno,gno;
